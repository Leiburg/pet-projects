# Проект 7. Выбираем авто выгодно  
## Юнит 8. Нейронные сети  
### skillfactory_rds  
![https://img.shields.io/badge/Python-3.7.4-blue](https://img.shields.io/badge/Python-3.7.4-blue)

## Оглавление  
[1. Описание проекта](https://github.com/alex-sokolov2011/skillfactory_rds/blob/master/module_7/README.md#Описание-проекта)  
[2. Какой кейс решаем?](https://github.com/alex-sokolov2011/skillfactory_rds/blob/master/module_7/README.md#Какой-кейс-решаем)  
[3. Краткая информация о данных](https://github.com/alex-sokolov2011/skillfactory_rds/blob/master/module_7/README.md#Краткая-информация-о-данных)  
[3. Этапы работы над проектом](https://github.com/alex-sokolov2011/skillfactory_rds/blob/master/module_7/README.md#Этапы-работы-над-проектом)  
[4. Результат](https://github.com/alex-sokolov2011/skillfactory_rds/blob/master/module_7/README.md#Результат)  

### Описание проекта  
Вы работаете в компании, которая занимается продажей автомобилей с пробегом в Москве. В этом модуле вам нужно построить модель классификации изображений. Классифицировать мы будем автомобили по их фотографиям  

***Чем мы будем заниматься?***  
- Построим свой классификатор изображений.
- Применим различные методы предобработки изображений
- Задействуем сразу несколько методов обучения (finetuning, transfer learning и так далее)
- Научимся использовать предобученные модели для решения своих задач
- Найдем и используем в работе State of the Art (SOTA)-модели  
:arrow_up:[к оглавлению](https://github.com/alex-sokolov2011/skillfactory_rds/blob/master/module_7/README.md#Оглавление)

### Какой кейс решаем?
Вы работаете в компании, которая занимается продажей автомобилей с пробегом в Москве.  
Основная задача компании и её менеджеров — максимально быстро находить выгодные предложения (проще говоря, купить ниже рынка, а продать дороже рынка).  
В прошлом проекте вы построили модель которая предсказывает стоимость автомобиля по его характеристикам.  
Теперь перед вам предстоит построить модель классификации изображений автомобилей по их фотографиям  

**Условия соревнования:**  
[Ссылка на закрытое соревнование](https://www.kaggle.com/c/sf-dl-car-classification)  
- Данное соревнование является бессрочным и доступно для всех потоков.
- Срок выполнения соревнования устанавливаеться индивидуально в каждом потоке.
- Тестовая выборка представлена в ЛидерБорде целиком.
- Лучшие и победные решения буду проверяться на воспроизводимость и "адекватность" (чтоб не было подгонки под тестовую выборку).

**Метрика качества**
Результаты оцениваются по метрике accuracy — доля правильных ответов модели  
:arrow_up:[к оглавлению](https://github.com/alex-sokolov2011/skillfactory_rds/blob/master/module_7/README.md#Оглавление)

### Краткая информация о данных
- train.csv - метки к тренировочной базе фотографий авто
- train.zip - тренировочная база фотографий авто (10 типов)
- test.zip - тестовая база фотографий авто
- sample-submission.csv - пример правильного формата submission file
  
:arrow_up:[к оглавлению](https://github.com/alex-sokolov2011/skillfactory_rds/blob/master/module_7/README.md#Оглавление)

### Этапы работы над проектом  

- сформировал предварительные гиперпараметры модели
- добавил Batch Normalization
- применил transfer learning с finetuning
- использовал разные техники управления LR
- применил разные функции callback (ModelCheckpoint, EarlyStopping, ReduceLROnPlateau, LearningRateScheduler)
- добавил TTA (Test Time Augmentation).

В ходе экспериментов:
- тестировались разные оптимизаторы (Adam, Nadam, Adamax)

:arrow_up:[к оглавлению](https://github.com/alex-sokolov2011/skillfactory_rds/blob/master/module_7/README.md#Оглавление)

### Результат  
score на kaggle = 0.97423 (13 место, 11%)  
К сожалению не хватило времени, чтобы - вычислить на каких картинках ошибается модель, попытаться дополнить этот класс фото извне и дообучить модель на сложных примерах
Использование внешних датасетов для дообучения модели.  
:arrow_up:[к оглавлению](https://github.com/alex-sokolov2011/skillfactory_rds/blob/master/module_7/README.md#Оглавление)